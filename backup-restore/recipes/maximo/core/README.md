Backup
----
### Steps for Maximo Core namespace backup

1. cd to `maximo/core`
2. Export Core required variables, this can be achieving by sourcing the `maximo_env.sh`:
    ```
    MAS_INSTANCE_ID (REQUIRED)
    REPORTING_OPERATOR (OPTIONAL, default: dro)
    REPORTING_OPERATOR_NAMESPACE (OPTIONAL, default: redhat-marketplace)
    KAFKA_NAMESPACE (Optional if installed in cluster)
    ```

    e.g
    `export MAS_INSTANCE_ID=inst1`


2. Run the prerequisite script, for more information, run with the `-h` option

    `./scripts/backup-pre-req.sh`

3. Apply the local recipe (frcpe) generated by the backup-pre-req script
   
    `oc apply -f maximo-core-backup-restore-local.yaml`
4. From Fusion Console, create backup policy (fbp) specifying the frequency for backups
5. From Fusion Console, associate the backup policy to the Core application. 
6.  Retrieve the Policy Assignment Name:

    `oc get fpa -n ibm-spectrum-fusion-ns -o custom-columns=NAME:.metadata.name --no-headers`
7.  Update policy assignments (fpa) with recipe name and namespace

    `oc -n ibm-spectrum-fusion-ns patch fpa <policy-assignment-name> --type merge -p '{"spec":{"recipe":{"name":"maximo-core-backup-restore-recipe", "namespace":"ibm-spectrum-fusion-ns"}}}'`
    ```
    recipe:
        name: maximo-core-backup-restore-recipe
        namespace: ibm-spectrum-fusion-ns
    ```

Restore
----
### Prerequisites:
Applications mongoce, ibm-sls, ibm-common-services, cert-manager and data reporting operator are already present on target cluster. Maximo ibm-operator-catalog should also be installed in cluster

**Optional:** Applications db2u and amq-streams are an optional prerequisite if they were configured on cluster


### Steps for Maximo Core namespace restore
1. Before restoring application run the prerequisite script:

    `./scripts/restore-pre-req.sh`
2. Start Core namespace restore to same or alternate cluster.
