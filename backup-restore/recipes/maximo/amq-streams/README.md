Backup
----

### Steps for Maximo AMQ-Streams namespace backup

**Note:** Only supported Kafka provider for Backup and Restore is AMQ-Streams

1. cd to `maximo/amq-streams`
   
2. Run the prerequisite script, if more information needed, run with the `-h` option

    `./scripts/backup-pre-req.sh`
3. Apply the local recipe (frcpe) generated by the backup-pre-req script

    `oc apply -f maximo-amq-streams-backup-restore-local.yaml`
4. From Fusion Console, create backup policy (fbp) specifying the frequency for backups
5. From Fusion Console, associate the backup policy to the AMQ Streams application. 
6. Retrieve the Policy Assignment Name:

    `oc get fpa -n ibm-spectrum-fusion-ns -o custom-columns=NAME:.metadata.name --no-headers`
7. Update policy assignments (fpa) with recipe name and namespace

    `oc -n ibm-spectrum-fusion-ns patch fpa <policy-assignment-name> --type merge -p '{"spec":{"recipe":{"name":"maximo-amq-streams-backup-restore-recipe", "namespace":"ibm-spectrum-fusion-ns"}}}'`
    ```
    recipe:
        name: maximo-amq-streams-backup-restore-recipe
        namespace: ibm-spectrum-fusion-ns
    ```

Restore
----
### Prerequisite: 
cert-manager

### Steps for Maximo AMQ Streams namespace restore
1. Before restoring application run the prerequisite script:

    `./scripts/restore-pre-req.sh`
2. Start AMQ Streams namespace restore to same or alternate cluster.
