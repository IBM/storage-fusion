Backup
----

### Steps for Maximo Db2u namespace backup

1. cd to `maximo/db2u`

2. Run the prerequisite script, if more information needed, run with the `-h` option

    `./scripts/backup-pre-req.sh`

3. Apply local recipe (frcpe) generated by the backup-pre-req script

    `oc apply -f maximo-db2-backup-restore-local.yaml`

Note: Following steps needs to be made on Hub cluster
4. From Fusion Console, create backup policy (fbp) specifying the frequency for backups
5. From Fusion Console, associate the backup policy to the Db2 application. 
6. Retrieve the Policy Assignment Name:

    `oc get fpa -n ibm-spectrum-fusion-ns -o custom-columns=NAME:.metadata.name --no-headers`
7. Update policy assignments (fpa) with recipe name and namespace

    `oc -n ibm-spectrum-fusion-ns patch fpa <policy-assignment-name> --type merge -p '{"spec":{"recipe":{"name":"maximo-db2-backup-restore-recipe", "namespace":"ibm-spectrum-fusion-ns"}}}'`
    ```
    recipe:
        name: maximo-db2-backup-restore-recipe
        namespace: ibm-spectrum-fusion-ns
    ```

Restore
----

### Prerequisite:
**Required:** <br>
RH [cert-manager](https://ibm-mas.github.io/ansible-devops/roles/cert_manager/)<br>
Maximo [ibm-operator-catalog](https://ibm-mas.github.io/ansible-devops/roles/ibm_catalogs/) should also be installed in cluster

### Steps for Maximo Db2 namespace restore
1. Before restoring application run the prerequisite script:

    `./scripts/restore-pre-req.sh`

2. Start Db2u namespace restore to same or alternate cluster.
